<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Past Questions Admin</title>

  <!-- Force the same (mobile) dark scheme everywhere -->
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#070A14" />

  <!-- (Optional but helpful) reduce aggressive caching in some setups -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    :root{
      color-scheme: dark; /* lock UI controls to dark */
      --bg:#070A14;
      --card:rgba(255,255,255,.05);
      --card2:rgba(255,255,255,.035);
      --stroke:rgba(255,255,255,.12);
      --stroke2:rgba(255,255,255,.08);
      --text:rgba(234,240,255,.92);
      --muted:rgba(234,240,255,.62);
      --muted2:rgba(234,240,255,.45);
      --good:rgba(35,181,168,.35);
      --warn:rgba(245,158,11,.35);
      --bad:rgba(239,68,68,.35);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --r:18px;
    }

    *{ box-sizing:border-box; }
    html, body { background-color: var(--bg); }
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(99,102,241,.18), transparent 60%),
        radial-gradient(800px 500px at 80% -10%, rgba(16,185,129,.12), transparent 55%),
        radial-gradient(700px 500px at 50% 110%, rgba(245,158,11,.09), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      line-height:1.35;
    }
    a{ color:inherit; }
    .wrap{ width:min(1180px, 92vw); margin:0 auto; padding:22px 0 40px; }

    /* top header (simple) */
    .site-header{
      position:sticky; top:0; z-index:50;
      background: rgba(7,10,20,.72);
      backdrop-filter: blur(14px);
      border-bottom: 1px solid var(--stroke2);
    }
    .container{ width:min(1180px, 92vw); margin:0 auto; }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 0;
      gap:14px;
    }
    .brand a{
      display:flex; align-items:center; gap:10px;
      text-decoration:none;
    }
    .brand img{
      width:40px; height:40px; border-radius:12px;
      border:1px solid var(--stroke);
      object-fit:cover;
      box-shadow: 0 10px 28px rgba(0,0,0,.45);
    }
    .brand .t1{ font-weight:700; font-size:13px; letter-spacing:.2px; }
    .brand .t2{ font-size:11px; color:var(--muted); margin-top:1px; }
    .navlinks{ display:flex; gap:14px; list-style:none; padding:0; margin:0; }
    .navlinks a{ text-decoration:none; font-size:13px; color:var(--muted); }
    .navlinks a:hover{ color:var(--text); }

    /* hero */
    .hero{ padding:18px 0 8px; }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      font-size:12px;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: rgba(99,102,241,.9);
      box-shadow: 0 0 0 6px rgba(99,102,241,.12);
    }
    h1{ margin:10px 0 6px; font-size:28px; letter-spacing:.2px; }
    .sub{ margin:0; color:var(--muted); max-width: 70ch; }
    .cta{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }

    /* cards */
    .card{
      border-radius: var(--r);
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .head{
      padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      border-bottom:1px solid var(--stroke2);
      background: rgba(255,255,255,.03);
    }
    .title{ font-weight:800; letter-spacing:.2px; }
    .hint{ font-size:12px; color:var(--muted); margin-top:3px; }
    .body{ padding:16px; }

    /* layout for upload + manage */
    .two{
      display:grid;
      grid-template-columns: 1fr 1.15fr;
      gap:14px;
      margin-top:14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .two{ grid-template-columns: 1fr; }
    }

    /* fields */
    .field{ display:block; }
    .lbl{ display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
    input, select, textarea{
      width:100%;
      padding:11px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,14,28,.55);
      color: var(--text);
      outline:none;
    }
    textarea{ min-height: 86px; resize: vertical; }
    input:focus, select:focus, textarea:focus{
      border-color: rgba(99,102,241,.38);
      box-shadow: 0 0 0 4px rgba(99,102,241,.12);
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width: 560px){
      .grid2{ grid-template-columns: 1fr; }
    }

    /* buttons */
    .btn{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
    }
    .btn:hover{ background: rgba(255,255,255,.09); }
    .btn:disabled{ opacity:.55; cursor:not-allowed; }
    .btn.primary{
      border-color: rgba(99,102,241,.35);
      background: rgba(99,102,241,.18);
    }
    .btn.primary:hover{ background: rgba(99,102,241,.22); }
    .btn.danger{
      border-color: rgba(239,68,68,.30);
      background: rgba(239,68,68,.14);
    }
    .btn.danger:hover{ background: rgba(239,68,68,.20); }
    .btn.ghost{
      background: transparent;
      border:1px dashed rgba(255,255,255,.16);
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }

    .actions{ display:flex; gap:8px; flex-wrap:wrap; }
    .miniBtn{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight:700;
      font-size:12px;
    }
    .miniBtn:hover{ background: rgba(255,255,255,.09); }
    .miniBtn.danger{
      border-color: rgba(239,68,68,.30);
      background: rgba(239,68,68,.12);
    }
    .miniBtn.danger:hover{ background: rgba(239,68,68,.18); }

    /* pills + toast */
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      white-space:nowrap;
    }
    .pill.good{ border-color: rgba(35,181,168,.30); background: rgba(35,181,168,.10); color: rgba(210,255,250,.86); }
    .pill.warn{ border-color: rgba(245,158,11,.30); background: rgba(245,158,11,.10); color: rgba(255,236,196,.92); }

    .toast{
      margin-top:12px;
      padding:10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color: var(--text);
      display:none;
    }
    .toast.ok{ border-color: rgba(35,181,168,.22); background: rgba(35,181,168,.10); }
    .toast.warn{ border-color: rgba(245,158,11,.22); background: rgba(245,158,11,.10); color: rgba(255,236,196,.92); }
    .toast.bad{ border-color: rgba(239,68,68,.24); background: rgba(239,68,68,.10); color: rgba(255,225,225,.92); }
    .toast.show{ display:block; }

    /* manage table */
    .toolbar{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
      margin-bottom: 12px;
    }
    table{ width:100%; border-collapse: collapse; min-width: 720px; }
    th, td{ padding:10px 10px; border-bottom: 1px solid rgba(255,255,255,.08); vertical-align:top; }
    th{ text-align:left; font-size:12px; color: var(--muted); }
    .rowTitle{ font-weight:800; }
    .rowSub{ margin-top:4px; font-size:12px; color: var(--muted); }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    /* embedded preview (upload + view) */
    .previewTools{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin: 10px 0 6px;
      flex-wrap:wrap;
    }
    .previewBox{
      margin-top:10px;
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      overflow:hidden;
      background: rgba(10,14,28,.40);
    }
    .pdfFrame{
      width:100%;
      height: min(52vh, 520px);
      border:0;
      display:block;
      background: rgba(0,0,0,.25);
    }
    .imgFrame{
      width:100%;
      height: min(52vh, 520px);
      display:block;
      object-fit: contain;
      background: rgba(0,0,0,.25);
      cursor: zoom-in;
    }

    /* modal */
    .modalOverlay{
      position: fixed; inset: 0;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      z-index: 100;
    }
    .modalOverlay.open{ display:flex; }
    .modal{
      width: min(760px, 100%);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(10,14,28,.92), rgba(10,14,28,.78));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal.wide{ width: min(1120px, 100%); }
    .mhead{
      padding: 14px 16px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
    }
    .mbody{ padding: 16px; }

    /* image zoom modal */
    .zoomStage{
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 10px;
      max-height: 78vh;
      overflow:auto;
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.25);
    }
    .zoomImg{
      max-width: 100%;
      max-height: 76vh;
      width: auto;
      height: auto;
      display:block;
      border-radius: 12px;
      cursor: zoom-out;
    }

    .footer{
      margin-top: 18px;
      color: rgba(234,240,255,.55);
      font-size: 12px;
      text-align:center;
    }
  </style>
</head>

<body>
  <header class="site-header">
    <div class="container">
      <div class="nav">
        <div class="brand">
          <a href="./index.html" title="Back to Home">
            <img src="./images/logo.jpg" alt="LSS Logo" />
            <div>
              <div class="t1">Law Students’ Society</div>
              <div class="t2">Joseph Ayo Babalola University</div>
            </div>
          </a>
        </div>

        <ul class="navlinks" id="navLinks">
          <li><a href="./index.html">Home</a></li>
          <li><a href="./resources.html">Resources</a></li>
          <li><a href="./pastquestions.html">Past Questions</a></li>
          <li><a href="./contact.html">Contact</a></li>
        </ul>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="badge"><span class="dot"></span> Past Questions Admin</div>
      <h1>Upload • Edit • Rename • Delete</h1>
      <p class="sub">
        Admin can now preview PDFs/images inside this page while filling the form.
      </p>

      <div class="cta">
        <a class="btn ghost" href="../pastquestions.html">Open Past Questions</a>
        <button class="btn" id="btnRefreshTop" type="button">Refresh List</button>
      </div>

      <div class="toast" id="toast"></div>
    </section>

    <!-- AUTH -->
    <section class="card" style="margin-top:16px;">
      <div class="head">
        <div>
          <div class="title">Admin Login</div>
          <div class="hint">Login to manage past questions.</div>
        </div>
        <div class="actions">
          <span class="pill" id="authPill">Not signed in</span>
          <button class="btn danger" id="btnLogout" style="display:none;" type="button">Logout</button>
        </div>
      </div>

      <div class="body">
        <div class="grid2">
          <label class="field">
            <span class="lbl">Email</span>
            <input id="loginEmail" type="email" placeholder="admin@jabulss.com" autocomplete="username" />
          </label>

          <label class="field">
            <span class="lbl">Password</span>
            <input id="loginPassword" type="password" placeholder="••••••••" autocomplete="current-password" />
          </label>
        </div>

        <div class="cta">
          <button class="btn primary" id="btnLogin" type="button">Login</button>
        </div>
      </div>
    </section>

    <section class="two">
      <!-- UPLOAD -->
      <section class="card" id="uploadCard">
        <div class="head">
          <div>
            <div class="title">Upload New</div>
            <div class="hint">Upload PDF or image. Add metadata. Publish immediately.</div>
          </div>
          <span class="pill warn">Max 35MB</span>
        </div>

        <div class="body">
          <label class="field">
            <span class="lbl">File</span>
            <input id="file" type="file" accept=".pdf,.png,.jpg,.jpeg,.webp,application/pdf,image/*" />
          </label>

          <div class="previewTools">
            <div class="actions">
              <button class="miniBtn" id="btnPreviewLocal" type="button">Preview selected</button>
              <button class="miniBtn" id="btnCloseLocalPreview" type="button">Close preview</button>
            </div>
            <span class="pill mono" id="localPreviewName">No file selected</span>
          </div>

          <div class="hint" style="margin-top:6px;">
            Tip: For images, click the preview to view full-size.
          </div>

          <!-- Local preview area -->
          <div class="previewBox" id="localPreviewWrap" style="display:none;">
            <iframe id="localPreviewPdf" class="pdfFrame" title="Selected PDF preview" style="display:none;"></iframe>
            <img id="localPreviewImg" class="imgFrame" alt="Selected image preview" style="display:none;" />
          </div>

          <div style="height:12px"></div>

          <div class="grid2">
            <label class="field">
              <span class="lbl">Course Code</span>
              <input id="course_code" placeholder="e.g. LAW 201" />
            </label>

            <label class="field">
              <span class="lbl">Course Title</span>
              <input id="course_title" placeholder="e.g. Constitutional Law" />
            </label>
          </div>

          <div style="height:10px"></div>

          <label class="field">
            <span class="lbl">Display Title</span>
            <input id="title" placeholder="What users will see" />
          </label>

          <div style="height:10px"></div>

          <div class="grid2">
            <label class="field">
              <span class="lbl">Level</span>
              <select id="level">
                <option value="">—</option>
                <option>100L</option><option>200L</option><option>300L</option><option>400L</option><option>500L</option>
              </select>
            </label>

            <label class="field">
              <span class="lbl">Semester</span>
              <select id="semester">
                <option value="">—</option>
                <option>First</option>
                <option>Second</option>
              </select>
            </label>
          </div>

          <div style="height:10px"></div>

          <div class="grid2">
            <label class="field">
              <span class="lbl">Type</span>
              <select id="type">
                <option>Exam</option>
                <option>Test</option>
                <option>Quiz</option>
              </select>
            </label>

            <label class="field">
              <span class="lbl">Session</span>
              <input id="session" placeholder="e.g. 2023/2024" />
            </label>
          </div>

          <div style="height:10px"></div>

          <label class="field">
            <span class="lbl">Notes (optional)</span>
            <textarea id="notes" placeholder="Any extra note..."></textarea>
          </label>

          <div style="height:10px"></div>

          <label class="field">
            <span class="lbl">Rename file as (optional)</span>
            <input id="safe_name" placeholder="e.g. law-201-constitutional-law (no extension)" />
            <div class="hint">If empty, the system generates a safe filename automatically.</div>
          </label>

          <div class="cta">
            <button class="btn primary" id="btnUpload" type="button">Upload</button>
            <button class="btn" id="btnClearUpload" type="button">Clear</button>
          </div>
        </div>
      </section>

      <!-- MANAGE -->
      <section class="card" id="manageCard">
        <div class="head">
          <div>
            <div class="title">Manage Library</div>
            <div class="hint">Search, preview, edit metadata, rename file, or delete.</div>
          </div>
          <span class="pill" id="countPill">0 items</span>
        </div>

        <div class="body">
          <div class="toolbar">
            <div class="actions" style="flex:1; flex-wrap:wrap;">
              <input id="q" placeholder="Search: title, course, session, notes." style="width:min(440px,100%);" />
              <select id="fLevel" style="width:140px;">
                <option value="">All Levels</option>
                <option>100L</option><option>200L</option><option>300L</option><option>400L</option><option>500L</option>
              </select>
              <select id="fSemester" style="width:160px;">
                <option value="">All Semesters</option>
                <option>First</option><option>Second</option>
              </select>
              <select id="fType" style="width:140px;">
                <option value="">All Types</option>
                <option>Exam</option><option>Test</option><option>Quiz</option>
              </select>
            </div>

            <div class="actions">
              <button class="btn" id="btnRefresh" type="button">Refresh</button>
            </div>
          </div>

          <div style="overflow:auto;">
            <table aria-label="Past questions table">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Meta</th>
                  <th>File</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="tbody"></tbody>
            </table>
          </div>

          <div class="hint" style="margin-top:10px;">
            Tip: “Rename” changes the actual file name on the server (Truehost) and updates the DB link.
          </div>
        </div>
      </section>
    </section>

    <div class="footer">
      © <span id="year"></span> Law Students’ Society, Joseph Ayo Babalola University.
    </div>

    <!-- VIEW MODAL -->
    <div class="modalOverlay" id="viewOverlay" aria-hidden="true">
      <div class="modal wide" role="dialog" aria-modal="true" aria-label="View file">
        <div class="mhead">
          <div style="min-width:0;">
            <div class="title" id="viewTitle">Preview</div>
            <div class="hint mono" id="viewMeta" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"></div>
          </div>
          <div class="actions">
            <a class="btn ghost" id="viewOpen" target="_blank" rel="noopener">Open in new tab</a>
            <button class="btn" id="btnViewClose" type="button">Close</button>
          </div>
        </div>
        <div class="mbody">
          <div class="previewBox">
            <iframe id="viewPdf" class="pdfFrame" title="PDF preview" style="display:none;"></iframe>
            <img id="viewImg" class="imgFrame" alt="Image preview" style="display:none;" />
          </div>
          <div class="hint" style="margin-top:10px;">
            For images, click the preview to view full-size. If a PDF preview is blank, use “Open in new tab”.
          </div>
        </div>
      </div>
    </div>

    <!-- IMAGE ZOOM MODAL -->
    <div class="modalOverlay" id="zoomOverlay" aria-hidden="true">
      <div class="modal wide" role="dialog" aria-modal="true" aria-label="Image viewer">
        <div class="mhead">
          <div style="min-width:0;">
            <div class="title" id="zoomTitle">Image</div>
            <div class="hint mono" id="zoomMeta" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"></div>
          </div>
          <div class="actions">
            <a class="btn ghost" id="zoomOpen" target="_blank" rel="noopener">Open in new tab</a>
            <button class="btn" id="btnZoomClose" type="button">Close</button>
          </div>
        </div>
        <div class="mbody">
          <div class="zoomStage">
            <img id="zoomImg" class="zoomImg" alt="Full image view" />
          </div>
          <div class="hint" style="margin-top:10px;">
            Tip: Scroll if the image is tall. Click the image to close.
          </div>
        </div>
      </div>
    </div>

    <!-- EDIT MODAL -->
    <div class="modalOverlay" id="editOverlay" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-label="Edit item">
        <div class="mhead">
          <div class="title">Edit Metadata</div>
          <button class="btn" id="btnEditClose" type="button">Close</button>
        </div>
        <div class="mbody">
          <input type="hidden" id="edit_id" />

          <div class="grid2">
            <label class="field">
              <span class="lbl">Display Title</span>
              <input id="edit_title" />
            </label>

            <label class="field">
              <span class="lbl">Course Code</span>
              <input id="edit_course_code" />
            </label>
          </div>

          <div style="height:10px"></div>

          <label class="field">
            <span class="lbl">Course Title</span>
            <input id="edit_course_title" />
          </label>

          <div style="height:10px"></div>

          <div class="grid2">
            <label class="field">
              <span class="lbl">Level</span>
              <select id="edit_level">
                <option value="">—</option>
                <option>100L</option><option>200L</option><option>300L</option><option>400L</option><option>500L</option>
              </select>
            </label>

            <label class="field">
              <span class="lbl">Semester</span>
              <select id="edit_semester">
                <option value="">—</option>
                <option>First</option>
                <option>Second</option>
              </select>
            </label>
          </div>

          <div style="height:10px"></div>

          <div class="grid2">
            <label class="field">
              <span class="lbl">Type</span>
              <select id="edit_type">
                <option>Exam</option>
                <option>Test</option>
                <option>Quiz</option>
              </select>
            </label>

            <label class="field">
              <span class="lbl">Session</span>
              <input id="edit_session" placeholder="e.g. 2023/2024" />
            </label>
          </div>

          <div style="height:10px"></div>

          <label class="field">
            <span class="lbl">Notes</span>
            <textarea id="edit_notes"></textarea>
          </label>

          <div class="cta">
            <button class="btn primary" id="btnEditSave" type="button">Save</button>
          </div>
        </div>
      </div>
    </div>

    <!-- RENAME MODAL -->
    <div class="modalOverlay" id="renameOverlay" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-label="Rename file">
        <div class="mhead">
          <div class="title">Rename File</div>
          <button class="btn" id="btnRenameClose" type="button">Close</button>
        </div>
        <div class="mbody">
          <input type="hidden" id="rename_id" />
          <label class="field">
            <span class="lbl">New safe name (no extension)</span>
            <input id="rename_safe" class="mono" placeholder="e.g. law-201-constitutional-law" />
            <div class="hint">Only letters/numbers become part of the filename. Spaces become hyphens.</div>
          </label>

          <div class="cta">
            <button class="btn primary" id="btnRenameDo" type="button">Rename</button>
          </div>
        </div>
      </div>
    </div>

  </main>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>

  <!-- cache-bust so laptop won’t keep old JS -->
  <script src="./admin.js?v=2025-12-21"></script>
</body>
</html>
